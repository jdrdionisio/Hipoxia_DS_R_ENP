{
  "hash": "affeb78075c74ce6965b40df6622cc8e",
  "result": {
    "markdown": "---\ntitle: \"Relatório sobre as dataset Hipóxias\"\nauthor: \"João Dionísio\"\ndate: today\ndate format: long\nformat:\n  html:\n    smooth-scroll: true\n    self-contained: true\n    toc: true\n    toc-location: right\ntheme: cosmo\nsmooth-scroll: true\nexecute:\n  warning: false\n  echo: true\nproject:\n  output-dir: outputs/documents\n---\n\n\n# Relatório sobre as dataset Hipóxias\n\nEste relatório foi criado no dia 10 setembro 2022. Foi utilizado a base de dados chamado de hypoxia que se encontra referida na sua forma base com o nome hipoxia.xlsx.\n\nNeste relatório inicial irei explorar de forma simples este dataset. Inicialmente\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exercicio \n# 1. Criar um projecto com o nome hipoxia\n# 2. Criar um relatorio em html ou docx conforme a preferencia \n# 3. Devem explorar o dataset hypoxia.xlsx  \n# 4. Nesse dataset devem explorar diferencas entre os doentes por tipo de cirurgia Type Surg \n# 5. Devem explorar nao so caracteristicas como outcomes\n# 6. em de apresentar representacoes graficas (3 graficos diferentes) e tabelas (2 tabelas) T\n# 7. Devem utilizar um modelo de regressao para avaliar se ha diferencas entre o valor de BMI por tipo de cirurgia ajustado pra sexo e idade  \n# 8. O documento docx ou html deve conter pelo menos, titulos, equacoes, listas e imagem p.e. um doente tipo com CPAP\n```\n:::\n\n\n## Instalar e Carregar Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOURCE: https://cedricscherer.netlify.app/2019/05/17/the-evolution-of-a-ggplot-ep.-1/#aim \n\n# Packages\nrequired_packages <- c(\n                       \"tidyverse\",   \n                       \"broom\",\n                       \"table1\",\n                       \"readxl\",\n                       #\"lubridate\",\n                       \"kableExtra\",\n                       \"patchwork\",\n                       \"MLDataR\",\n                       \"here\",\n                       \"ggthemes\"\n                       #\"tidyverse\"\n                       )      \n#ploty \nfor (pkg in required_packages) {\n  # install packages if not already present\n  if (!pkg %in% rownames(installed.packages())) {\n    install.packages(pkg)\n  }\n  \n  # load packages to this current session \n  library(pkg, character.only = TRUE)\n}\n```\n:::\n\n\nPara uma questão de coerência e para não me esquecer no futuro deixo a seed definida para possíveis análises e a limpeza do environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\n#### Clean enviorment\n\n\nrm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.\n```\n:::\n\n\n## Explorar o dataset hypoxia.xlsx\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhypoxia <- read_excel(\"datasets/hypoxia.xlsx\")\nView(hypoxia)\n```\n:::\n\n\nLimpeza das variáveis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"janitor\")\nlibrary(janitor)\nhypoxia_1 <- janitor::clean_names(hypoxia)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia_lite <- hypoxia_1 %>%\n  select(age,\n         female,\n         race,\n         bmi,\n         sleeptime,\n         min_sao2,\n         diabetes,\n         smoking,\n         hyper,\n         cad,\n         cpap,\n         type_surg)\n\n\n#Penso que sera possivel simplificar este cofigo\n#\n\n#mulheres\nunit_female <- hipoxia_lite %>%\n  summarise(female_mean= round(mean(female),2))\n  \n\na <- unit_female*100\n#fumadores\nunit_smokers <- hipoxia_lite %>%\n  summarise(smokers_mean= round(mean(smoking),2))\n\nb <- unit_smokers*100\n\n#hipertensos\nunit_hta <- hipoxia_lite %>%\n  summarise(hyper_mean= round(mean(hyper),2))\n\nc <- unit_hta*100\n\n#CAD\nunit_diabetes <- hipoxia_lite %>%\n  summarise(db_mean= round(mean(diabetes),2))\n\nd <- unit_diabetes*100\n\n#CPAP\nunit_cpap <- hipoxia_lite %>%\n  summarise(cpap_mean = round(mean(cpap),2))\n\ne <- unit_cpap*100\n  #footnote(general = \"Here is a general comments of the table. \",\n# Poderiamos ter \n\n#library(table1)\n\n#t1<- table1(~ factor(sex) + \n #        age + \n  #       factor(resting_ecg) + \n   #      cholesterol +\n    #     resting_bp | \n     #    heart_disease, \n      # data=hd,\n      # footnote = \"Source: MLData R\",\n       #caption = \"Descriptive variables by health disease\"\n      # )\n\n#library(openxlsx)\n#t1\n#table1 <- as.data.frame(t1)\n#write.xlsx(table1, file = here::here(\"outputs\", \n #                 paste0(\"table1_\", Sys.Date(),\".xlsx\")) \n  #         )\n```\n:::\n\n\n### Dados descritivos de variáveis binárias - em percentagem\n\nA percetagem de mulheres no dataset é 72%\n\nA percetagem de fumadores no dataset é 50%\n\nA percetagem de diabeticos no dataset é 35%\n\nA percetagem de hipertensos no dataset é 71%\n\nA percentagem de utilizadores de CPAP 63%\n\nExemplo de tabela discritiva\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrace_df <- hipoxia_lite %>%\n  group_by(race) %>%\n  summarise(cases_race=n())%>%\n  mutate(race = case_when(\n    race == 1 ~ \"African American\",\n    race == 2 ~ \"Caucasian\",\n    race == 3 ~ \"Other\"\n  ))%>%\n  rename(\"Race\" = race)%>%\n  rename(\"N()\"= cases_race)\n\ntable_race <- race_df %>%\n  kbl(digits = 2 # casas decimais\n      ,caption = \"Número de individuos, por raça\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n\ntable_race\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Número de individuos, por raça</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Race </th>\n   <th style=\"text-align:right;\"> N() </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> African American </td>\n   <td style=\"text-align:right;\"> 57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Caucasian </td>\n   <td style=\"text-align:right;\"> 216 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Explorar diferencas entre os doentes por tipo de cirurgia Type Surg\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntype_surg_df <- hipoxia_lite %>%\n  mutate(type_surg = case_when(\n    type_surg == 1 ~ \"Gastroenterostomy\",\n    type_surg == 2 ~ \"Gastric restrictive procedure\",\n    type_surg == 3 ~ \"Gastroplasty\",\n    type_surg == 4 ~ \"Removal of gastric restrictive device\",\n  ))%>%\n  group_by(type_surg)\n\ntotal_cirurgias <- type_surg_df %>%\n  summarise(\"N\" = n())%>%\n  summarise(N= sum(N))\n\ntotal_cirurgias_N <- pull(total_cirurgias,1)\n  \ntype_surg_df_N <- type_surg_df %>%\n  summarise(N = n())%>%\n  arrange(desc(N))%>%\n  mutate(\n   Percentagem = N / total_cirurgias_N *100)\n  \n#quero adicionar a percetagem de cada cirurgia no total\n\ntable_surg_N <- type_surg_df_N %>%\n  kbl(digits = 2 # casas decimais\n      ,caption = \"Número de cirurgias por tipo de procedimento\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n\ntype_surg_df_fem <- type_surg_df  %>%\n  summarise(percent_sex=mean(female, na.rm = TRUE)*100)%>%\n  arrange(percent_sex)\n\ntable_surg_female <- type_surg_df_fem %>%\n  kbl(digits = 2 # casas decimais\n      ,caption = \"Percentagem de mulheres por tipo de cirurgia\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n\ntype_surg_df_bmi <- type_surg_df  %>%\n  summarise(mean_bmi=mean(bmi, na.rm = TRUE),\n            sd_bmi=sd(bmi, na.rm = TRUE),\n            min_bmi=min(bmi, na.rm = TRUE),\n            max_bmi=max(bmi, na.rm = TRUE)\n            )%>%\n  rename(\"Média de BMI\"= mean_bmi,\n         \"DP do BMI\"= sd_bmi,\n         \"Min\"=min_bmi,\n         \"Max\"=max_bmi,\n         \"Tipo de cirurgia\"= type_surg)\n\ntable_surg_bmi <- type_surg_df_bmi %>%\n  kbl(digits = 3 # casas decimais\n      ,caption = \"Índice de Massa Corporal por cirurgia,(média, desvio-padrão, minimo e máximo)\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n\ntype_surg_df_age <- type_surg_df  %>%\n  summarise(mean_age=mean(age, na.rm = TRUE),\n            sd_age=sd(age, na.rm = TRUE),\n            min_age=min(age, na.rm = TRUE),\n            max_age=max(age, na.rm = TRUE)\n            )%>%\n  rename(\"Média de Idade\"= mean_age,\n         \"DP da Idade\"= sd_age,\n         \"Min\"=min_age,\n         \"Max\"=max_age)\n\ntable_surg_age <- type_surg_df_age %>%\n  kbl(digits = 3 # casas decimais\n      ,caption = \"Idade por cirurgia,(média, desvio-padrão, minimo e máximo)\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n\n# colocar tabela em baixo\nsum_race <- hipoxia_lite %>%\n    group_by(type_surg,race) %>%\n    summarise(n_race=dplyr::n()\n    )\n\nsum_race <- sum_race %>%\n  mutate(\n    race = case_when(\n      race ==1 ~ \"N_African_American\",\n      race ==2 ~ \"N_Caucasian\",\n      race ==3 ~ \"N_Other_race\"\n      )\n  )\n\nsum_race <- sum_race %>%\npivot_wider(names_from = race, values_from = n_race)\n\nsum_race <- sum_race %>%\n  mutate(\n    N_African_American = ifelse(is.na(N_African_American), 0, N_African_American),\n    N_Caucasian = ifelse(is.na(N_Caucasian), 0, N_Caucasian),\n    N_Other_Race = ifelse(is.na(N_Other_race), 0, N_Other_race)\n  )%>%\n  mutate(type_surg = case_when(\n    type_surg == 1 ~ \"Gastroenterostomy\",\n    type_surg == 2 ~ \"Gastric restrictive procedure\",\n    type_surg == 3 ~ \"Gastroplasty\",\n    type_surg == 4 ~ \"Removal of gastric restrictive device\",\n  ))\n\ntable_surg_race <- sum_race %>%\n  kbl(digits = 2 # casas decimais\n      ,caption = \"Distribuição de utentes por raça e por tipo de cirurgia\") %>%\n  kable_classic(full_width = F, #mantem numa linha\n                html_font = \"Calibri\")\n#sum_hypoxia <- left_join(sum_hypoxia, sum_race, by=\"type_surg\")\n```\n:::\n\n\n###Número de Cirurgias, por N e por percentagem do total\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable_surg_N\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Número de cirurgias por tipo de procedimento</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> type_surg </th>\n   <th style=\"text-align:right;\"> N </th>\n   <th style=\"text-align:right;\"> Percentagem </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 80.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 18.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroplasty </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Removal of gastric restrictive device </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.71 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nnome_cirur_ref <- first(type_surg_df_N$type_surg)\nnumero_cirur_ref <- first(type_surg_df_N$N)\npercent_cirur_ref <- first(type_surg_df_N$Percentagem,1)\n```\n:::\n\n\nO número de cirurgias total foi *281* com a intervenção de referência a ser a *Gastroenterostomy *com *225* compondo *80.0711744* do total de cirurgias.\n\n###Percentagem de utentes femininos por tipo de cirurgia\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# colocar aqui as tabelas dos primeiras\ntable_surg_female\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Percentagem de mulheres por tipo de cirurgia</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> type_surg </th>\n   <th style=\"text-align:right;\"> percent_sex </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 62.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroplasty </td>\n   <td style=\"text-align:right;\"> 66.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 73.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Removal of gastric restrictive device </td>\n   <td style=\"text-align:right;\"> 100.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n###Distribuição de utentes por raça e por tipo de cirurgia\n\ntable_surg_bmi\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# colocar aqui as tabelas dos primeiras\ntable_surg_race\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Distribuição de utentes por raça e por tipo de cirurgia</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> type_surg </th>\n   <th style=\"text-align:right;\"> N_African_American </th>\n   <th style=\"text-align:right;\"> N_Caucasian </th>\n   <th style=\"text-align:right;\"> N_Other_race </th>\n   <th style=\"text-align:right;\"> N_Other_Race </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 43 </td>\n   <td style=\"text-align:right;\"> 176 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroplasty </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Removal of gastric restrictive device </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n###Média e desvio-padrão do Índice de Massa corporal, por tipo de cirurgia\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable_surg_bmi \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Índice de Massa Corporal por cirurgia,(média, desvio-padrão, minimo e máximo)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Tipo de cirurgia </th>\n   <th style=\"text-align:right;\"> Média de BMI </th>\n   <th style=\"text-align:right;\"> DP do BMI </th>\n   <th style=\"text-align:right;\"> Min </th>\n   <th style=\"text-align:right;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 43.794 </td>\n   <td style=\"text-align:right;\"> 6.323 </td>\n   <td style=\"text-align:right;\"> 34.0 </td>\n   <td style=\"text-align:right;\"> 71.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 47.391 </td>\n   <td style=\"text-align:right;\"> 8.007 </td>\n   <td style=\"text-align:right;\"> 23.4 </td>\n   <td style=\"text-align:right;\"> 70.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroplasty </td>\n   <td style=\"text-align:right;\"> 48.233 </td>\n   <td style=\"text-align:right;\"> 2.173 </td>\n   <td style=\"text-align:right;\"> 45.9 </td>\n   <td style=\"text-align:right;\"> 50.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Removal of gastric restrictive device </td>\n   <td style=\"text-align:right;\"> 47.600 </td>\n   <td style=\"text-align:right;\"> 2.546 </td>\n   <td style=\"text-align:right;\"> 45.8 </td>\n   <td style=\"text-align:right;\"> 49.4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Nao aplicar já fazer se for para pôr valores em inline\n#list_types <- c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")\n\n#var_names <- paste0(\"r\", 1:4)\n\n#for (i in seq_along(var_names)){\n # assign(var_names[[i]], sum_hypoxia %>% filter(type_surg==list_types[[i]]) %>% pull(n_surgeries))\n#}\n```\n:::\n\n###Tabelas discritivas com o table 1\n\nApós fazer algumas tabelas com o Kable Extras decidi mudar para o table 1\n\n::: {.cell}\n\n```{.r .cell-code}\nhypoxia_2_descrip <- hypoxia_1 %>%\n  mutate(type_surg = as.factor(type_surg))%>%\n  mutate(type_surg = case_when(\n    type_surg == 1 ~ \"Gastroenterostomy\",\n    type_surg == 2 ~ \"Gastric restrictive procedure\",\n    type_surg == 3 ~ \"Gastroplasty\",\n    type_surg == 4 ~ \"Removal of gastric restrictive device\"))\n\n\nt1<- table1(~ setLabel(factor(female),\"Female\") +\n              setLabel(age,\"Age\") +\n              setLabel(bmi,\"BMI\") +\n              setLabel(factor(race),\"Race\") +\n              setLabel(factor(smoking), \"Smoking\") +\n              factor(diabetes) +\n              factor(hyper) +\n              factor(cpap)+\n              sleeptime |\n              `type_surg`,\n            data=hypoxia_2_descrip,\n      # footnote = \"Source: MLData R\",\n       caption = \"Descriptive variables by type of surgery\"\n       )\nt1\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\"><caption>Descriptive variables by type of surgery</caption>\n\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastric restrictive procedure<br><span class='stratn'>(N=51)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastroenterostomy<br><span class='stratn'>(N=225)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastroplasty<br><span class='stratn'>(N=3)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Removal of gastric restrictive device<br><span class='stratn'>(N=2)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=281)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Female</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>19 (37.3%)</td>\n<td>60 (26.7%)</td>\n<td>1 (33.3%)</td>\n<td>0 (0%)</td>\n<td>80 (28.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>32 (62.7%)</td>\n<td class='lastrow'>165 (73.3%)</td>\n<td class='lastrow'>2 (66.7%)</td>\n<td class='lastrow'>2 (100%)</td>\n<td class='lastrow'>201 (71.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Age</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>49.8 (13.8)</td>\n<td>46.9 (10.3)</td>\n<td>33.0 (4.37)</td>\n<td>51.9 (9.83)</td>\n<td>47.3 (11.1)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>51.3 [17.9, 72.9]</td>\n<td class='lastrow'>47.8 [16.4, 73.8]</td>\n<td class='lastrow'>32.6 [28.9, 37.6]</td>\n<td class='lastrow'>51.9 [44.9, 58.8]</td>\n<td class='lastrow'>48.2 [16.4, 73.8]</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>BMI</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>43.8 (6.32)</td>\n<td>47.4 (8.01)</td>\n<td>48.2 (2.17)</td>\n<td>47.6 (2.55)</td>\n<td>46.7 (7.77)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>43.5 [34.0, 71.7]</td>\n<td class='lastrow'>47.0 [23.4, 70.1]</td>\n<td class='lastrow'>48.6 [45.9, 50.2]</td>\n<td class='lastrow'>47.6 [45.8, 49.4]</td>\n<td class='lastrow'>46.0 [23.4, 71.7]</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Race</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>1</td>\n<td>12 (23.5%)</td>\n<td>43 (19.1%)</td>\n<td>2 (66.7%)</td>\n<td>0 (0%)</td>\n<td>57 (20.3%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>2</td>\n<td>38 (74.5%)</td>\n<td>176 (78.2%)</td>\n<td>1 (33.3%)</td>\n<td>1 (50.0%)</td>\n<td>216 (76.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>3</td>\n<td class='lastrow'>1 (2.0%)</td>\n<td class='lastrow'>6 (2.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (50.0%)</td>\n<td class='lastrow'>8 (2.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Smoking</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>30 (58.8%)</td>\n<td>105 (46.7%)</td>\n<td>3 (100%)</td>\n<td>2 (100%)</td>\n<td>140 (49.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>21 (41.2%)</td>\n<td class='lastrow'>120 (53.3%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>141 (50.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(diabetes)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>35 (68.6%)</td>\n<td>145 (64.4%)</td>\n<td>3 (100%)</td>\n<td>1 (50.0%)</td>\n<td>184 (65.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>16 (31.4%)</td>\n<td class='lastrow'>80 (35.6%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (50.0%)</td>\n<td class='lastrow'>97 (34.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(hyper)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>16 (31.4%)</td>\n<td>65 (28.9%)</td>\n<td>1 (33.3%)</td>\n<td>0 (0%)</td>\n<td>82 (29.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>35 (68.6%)</td>\n<td class='lastrow'>160 (71.1%)</td>\n<td class='lastrow'>2 (66.7%)</td>\n<td class='lastrow'>2 (100%)</td>\n<td class='lastrow'>199 (70.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(cpap)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>20 (39.2%)</td>\n<td>80 (35.6%)</td>\n<td>2 (66.7%)</td>\n<td>1 (50.0%)</td>\n<td>103 (36.7%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>31 (60.8%)</td>\n<td class='lastrow'>145 (64.4%)</td>\n<td class='lastrow'>1 (33.3%)</td>\n<td class='lastrow'>1 (50.0%)</td>\n<td class='lastrow'>178 (63.3%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>sleeptime</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>20.2 (24.7)</td>\n<td>18.7 (23.7)</td>\n<td>3.00 (2.21)</td>\n<td>8.95 (4.03)</td>\n<td>18.7 (23.7)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>8.30 [0, 85.4]</td>\n<td class='lastrow'>8.10 [0, 99.6]</td>\n<td class='lastrow'>3.80 [0.500, 4.70]</td>\n<td class='lastrow'>8.95 [6.10, 11.8]</td>\n<td class='lastrow'>8.10 [0, 99.6]</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n## Representações Gráficas\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<- ggplot(hipoxia_lite, \n       aes(x=sleeptime, \n           y=bmi, \n           colour=as.factor(type_surg))\n       )+ \n  \n  geom_point(alpha=0.5\n             ) +\n\n  \n  scale_colour_discrete(labels=c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")) +\n  \n    labs(title = \"Sleep time and BMI\",\n         subtitle = \"By type of surgery\",\n         y = \"BMI\",\n         x = \"Sleptime\", \n         caption = \"Source: Course R\",\n       colour=\"\") +\n   theme_minimal() +\n  theme(legend.position=\"bottom\")\n\np1\n```\n\n::: {.cell-output-display}\n![](Hipoxia_Main_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n###Boxplot com o tempo de cirurgia por tipo de cirurgia\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2<- ggplot() +\n  geom_boxplot(data= hypoxia_1, \n            aes(x = as.factor(type_surg), y = duration_of_surg ),\n            outlier.shape = NA,\n            fill = \"light blue\", \n            colour = \"black\")+ \n  scale_x_discrete(labels=c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")) +\n  labs(title = \"Duration of Surgery\",\n         subtitle = \"By type of surgery\",\n         y = \"Duration of Surgery\",\n         x = \"Type of Surgery\", \n         caption = \"Source: Course R\",\n       colour=\"\") +\n  theme_minimal() +\n  theme(legend.position=\"bottom\")\n\np2\n```\n\n::: {.cell-output-display}\n![](Hipoxia_Main_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nUma questão que poderá surgir é se o BMI poderá influenciar o tempo de cirurgia\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia_2 <- hypoxia_1 %>%\n  mutate(BMI_cat = case_when(\n     bmi = (bmi<18.5) ~ \"Underweight\",\n     bmi = (bmi>=18.5 & bmi<24.5) ~ \"Normal\",\n     bmi = (bmi>=24.5 & bmi<29.9) ~ \"Overweight\",\n     bmi = (bmi>=30) ~ \"Obese\"\n  ) \n  )\n\n#list_bmi <- c(\"Underweight\",\"Normal\",\"Overweight\",\"Obese\")\n\n#var_names <- paste0(\"p\",3:6)\n\n# for (i in seq_along(var_names)){\n# assign(var_names[[i]], ggplot() +\n# geom_boxplot(data= hypoxia_1,\n#            aes(x = as.factor(type_surg), y = duration_of_surg ),\n#            outlier.shape = NA)+ #NEW to Exclude outliers +\n# scale_x_discrete(labels=c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")) +\n# labs(title = \"Duration of Surgery\",\n#       subtitle = paste0(\"By type of surgery\",\",\",list_bmi[[i]]),\n#      y = \"Duration of Surgery\",\n#     x = \"Type of Surgery\",\n#    caption = \"Source: Course R\",\n# colour=\"\") +\n# theme_minimal() +\n# theme(legend.position=\"bottom\"))\n# }\n\np3<- ggplot() +\n  geom_boxplot(data= hipoxia_2 %>% filter(BMI_cat == \"Underweight\" | BMI_cat == \"Normal\"), \n            aes(x = as.factor(type_surg), \n                y = duration_of_surg ),\n                outlier.shape = NA)+ \n  facet_wrap(~BMI_cat) +#NEW to Exclude outliers +\n  scale_x_discrete(labels=c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")) +\n  labs(title = \"Duration of Surgery\",\n        subtitle = \"By type of surgery\",\n        y = \"Duration of Surgery\",\n        x = \"Type of Surgery\", \n        caption = \"Source: Course R\",\n        colour=\"\") +\n  theme_minimal() +\n  theme(legend.position=\"bottom\")\n\n\np4 <-ggplot() +\n  geom_boxplot(data= hipoxia_2 %>% filter(BMI_cat == \"Overweight\" | BMI_cat == \"Obese\"), \n            aes(x = as.factor(type_surg), \n                y = duration_of_surg ),\n                outlier.shape = NA)+ \n  facet_wrap(~BMI_cat) +#NEW to Exclude outliers +\n  scale_x_discrete(labels=c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")) +\n  labs(title = \"Duration of Surgery\",\n        subtitle = \"By type of surgery\",\n        y = \"Duration of Surgery\",\n        x = \"Type of Surgery\", \n        caption = \"Source: Course R\",\n        colour=\"\") +\n  theme_minimal() +\n  theme(legend.position=\"bottom\")\n\n\np5<-p3/p4\n```\n:::\n\n\nNão se questionem mais porque todos os utentes são obesos com apenas um individuo Normal.\n\n###Relação entre o sleeptime e o minsao2\n\n::: {.cell}\n\n```{.r .cell-code}\np7<-ggplot(data = hipoxia_2 %>% drop_na(ahi), \n       aes(x=sleeptime, \n           y=min_sao2,\n           colour= as.factor(ahi))) + \n  geom_point(alpha=0.2) +\n  geom_smooth( method=lm,\n               se=FALSE,\n               linetype=\"dashed\"\n    \n  )+\n  labs(title = \"Realationship between Time Slept under <90% and Minimum Sat O2\",\n         y = \"Minimum saturation O2\",\n         x = \"Time spent at Sat. of O2 < 90%\", \n         caption = \"Source: Course R\",\n       fill=\"\",\n       colour=\"AHI\")\n  theme_minimal()+\n  theme(legend.position=\"right\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 93\n $ line                      :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 0.5\n  ..$ linetype     : num 1\n  ..$ lineend      : chr \"butt\"\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ rect                      :List of 5\n  ..$ fill         : chr \"white\"\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 0.5\n  ..$ linetype     : num 1\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ text                      :List of 11\n  ..$ family       : chr \"\"\n  ..$ face         : chr \"plain\"\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 11\n  ..$ hjust        : num 0.5\n  ..$ vjust        : num 0.5\n  ..$ angle        : num 0\n  ..$ lineheight   : num 0.9\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ title                     : NULL\n $ aspect.ratio              : NULL\n $ axis.title                : NULL\n $ axis.title.x              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.top          :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.bottom       : NULL\n $ axis.title.y              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.y.left         : NULL\n $ axis.title.y.right        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text                 :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"grey30\"\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.top           :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.bottom        : NULL\n $ axis.text.y               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 1\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.y.left          : NULL\n $ axis.text.y.right         :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.ticks                : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.ticks.x              : NULL\n $ axis.ticks.x.top          : NULL\n $ axis.ticks.x.bottom       : NULL\n $ axis.ticks.y              : NULL\n $ axis.ticks.y.left         : NULL\n $ axis.ticks.y.right        : NULL\n $ axis.ticks.length         : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ axis.ticks.length.x       : NULL\n $ axis.ticks.length.x.top   : NULL\n $ axis.ticks.length.x.bottom: NULL\n $ axis.ticks.length.y       : NULL\n $ axis.ticks.length.y.left  : NULL\n $ axis.ticks.length.y.right : NULL\n $ axis.line                 : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.line.x               : NULL\n $ axis.line.x.top           : NULL\n $ axis.line.x.bottom        : NULL\n $ axis.line.y               : NULL\n $ axis.line.y.left          : NULL\n $ axis.line.y.right         : NULL\n $ legend.background         : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.margin             : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing            : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing.x          : NULL\n $ legend.spacing.y          : NULL\n $ legend.key                : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.key.size           : 'simpleUnit' num 1.2lines\n  ..- attr(*, \"unit\")= int 3\n $ legend.key.height         : NULL\n $ legend.key.width          : NULL\n $ legend.text               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.text.align         : NULL\n $ legend.title              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.title.align        : NULL\n $ legend.position           : chr \"right\"\n $ legend.direction          : NULL\n $ legend.justification      : chr \"center\"\n $ legend.box                : NULL\n $ legend.box.just           : NULL\n $ legend.box.margin         : 'margin' num [1:4] 0cm 0cm 0cm 0cm\n  ..- attr(*, \"unit\")= int 1\n $ legend.box.background     : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.box.spacing        : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n $ panel.background          : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ panel.border              : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ panel.spacing             : 'simpleUnit' num 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ panel.spacing.x           : NULL\n $ panel.spacing.y           : NULL\n $ panel.grid                :List of 6\n  ..$ colour       : chr \"grey92\"\n  ..$ size         : NULL\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ panel.grid.major          : NULL\n $ panel.grid.minor          :List of 6\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.5\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ panel.grid.major.x        : NULL\n $ panel.grid.major.y        : NULL\n $ panel.grid.minor.x        : NULL\n $ panel.grid.minor.y        : NULL\n $ panel.ontop               : logi FALSE\n $ plot.background           : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ plot.title                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1.2\n  ..$ hjust        : num 0\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 5.5points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ plot.title.position       : chr \"panel\"\n $ plot.subtitle             :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 5.5points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ plot.caption              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : num 1\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 5.5points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ plot.caption.position     : chr \"panel\"\n $ plot.tag                  :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1.2\n  ..$ hjust        : num 0.5\n  ..$ vjust        : num 0.5\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ plot.tag.position         : chr \"topleft\"\n $ plot.margin               : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ strip.background          : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ strip.background.x        : NULL\n $ strip.background.y        : NULL\n $ strip.placement           : chr \"inside\"\n $ strip.text                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"grey10\"\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 4.4points 4.4points 4.4points 4.4points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ strip.text.x              : NULL\n $ strip.text.y              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ strip.switch.pad.grid     : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ strip.switch.pad.wrap     : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ strip.text.y.left         :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi TRUE\n - attr(*, \"validate\")= logi TRUE\n```\n:::\n\n```{.r .cell-code}\np7\n```\n\n::: {.cell-output-display}\n![](Hipoxia_Main_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n### Nova visualização - Ainda a pesquisar\n\n## Modelo de regressao para avaliar se ha diferencas entre o valor de BMI por tipo de cirurgia ajustado pra sexo e idade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia_lite$type_surg <- as.factor(hipoxia_lite$type_surg)# forcar o R a definir tipo de instituicao como variavel categorica\n\nhipoxia_lite$type_surg <- relevel(hipoxia_lite$type_surg, ref = 1)\n\n#hipoxia_lite_mdf <- hipoxia_lite %>%\n # filter()\n\nmodel2 <- lm(bmi ~ \n               as.factor(type_surg)+ # variaveis explicativas\n               as.factor(female)+\n               age, \n             data= hipoxia_lite)\n\n# We can with the Broom package make the model object in a tidy model \nmodel2_tidy <- tidy(model2, conf.int = TRUE)\n\nmodel2_tidy <- model2_tidy %>%\n    mutate(\n    term = case_when(\n      term ==\"(Intercept)\" ~ \"Gastroenterostomy(Referência)\",\n      term ==\"as.factor(type_surg)2\" ~ \"Gastric restrictive procedure\",\n      term ==\"as.factor(type_surg)3\" ~ \"Gastroplasty\",\n      term ==\"as.factor(type_surg)4\" ~ \"Removal of gastric restrictive device\",\n      term ==\"as.factor(female)1\" ~ \"Female\",\n    ))%>%\n    filter(!is.na(term))\n\nmodel2_tidy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 7\n  term                          estim…¹ std.e…² stati…³  p.value conf.…⁴ conf.…⁵\n  <chr>                           <dbl>   <dbl>   <dbl>    <dbl>   <dbl>   <dbl>\n1 Gastroenterostomy(Referência)   55.7     2.20  25.3   9.35e-74   51.4   60.0  \n2 Gastric restrictive procedure   -3.29    1.17  -2.80  5.51e- 3   -5.60  -0.974\n3 Gastroplasty                    -1.42    4.40  -0.322 7.48e- 1  -10.1    7.25 \n4 Removal of gastric restricti…    1.34    5.35   0.250 8.03e- 1   -9.19  11.9  \n5 Female                          -1.32    1.00  -1.31  1.92e- 1   -3.29   0.663\n# … with abbreviated variable names ¹​estimate, ²​std.error, ³​statistic,\n#   ⁴​conf.low, ⁵​conf.high\n```\n:::\n\n```{.r .cell-code}\n# model2_tidy_sig <- model2_tidy_sig %>%\n#     mutate(\n#     term = case_when(\n#       term ==\"(Intercept)\" ~ \"Gastroenterostomy(Referência)\",\n#       term ==\"as.factor(type_surg)2\" ~ \"Gastric restrictive procedure\",\n#       term ==\"as.factor(type_surg)3\" ~ \"Gastroplasty\",\n#       term ==\"as.factor(type_surg)4\" ~ \"Removal of gastric restrictive device\",\n#       term ==\"as.factor(female)1\" ~ \"Female\",\n#     ))%>%\n#     filter(!is.na(term))\n# Inspect the model\n\n# The glance function provides the most model diagnostics indicators\nmodel2_glance <-glance(model2)\n# Para verificação de resultados\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# filtrar as colunas significativas e coloca-las em vector para coloca-las como inline no texto\n#model2_tidy_sig1 <- model2_tidy_sig %>%\n  #filter(p.value<0,05)%>%\n  #pull(term)\n  \n#model2_tidy_sig1\n```\n:::\n\n\nVerifica-se que apenas a Gastric restrictive procedure tem uma diferença signitivamente significativa para o BMI em relação à cirurgia de referência (Gastroenterostomy).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lets visualize our model \nmodel2_augment <- augment(model2)\n\nmodel2_augment\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 281 × 9\n     bmi as.factor(type_s…¹ as.fa…²   age .fitted    .hat .sigma .cooksd .std.…³\n   <dbl> <fct>              <fct>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl>   <dbl>\n 1  44.5 2                  1        29.9    46.4 0.0328    7.52 3.80e-4 -0.259 \n 2  40.6 1                  1        52.2    46.2 0.00680   7.52 6.40e-4 -0.749 \n 3  61.7 1                  1        37.3    48.5 0.00807   7.48 4.19e-3  1.76  \n 4  40.2 1                  1        52.2    46.2 0.00680   7.52 7.35e-4 -0.802 \n 5  57.6 1                  1        26.7    50.2 0.0171    7.51 2.86e-3  0.993 \n 6  36   2                  1        54.6    42.5 0.0231    7.51 3.06e-3 -0.882 \n 7  39.2 1                  1        54      45.9 0.00755   7.51 1.02e-3 -0.899 \n 8  54.7 1                  1        53.2    46.1 0.00719   7.51 1.61e-3  1.16  \n 9  43.9 1                  1        47.4    47.0 0.00575   7.52 1.61e-4 -0.408 \n10  47.2 1                  0        57.4    46.7 0.0161    7.53 1.20e-5  0.0662\n# … with 271 more rows, and abbreviated variable names ¹​`as.factor(type_surg)`,\n#   ²​`as.factor(female)`, ³​.std.resid\n```\n:::\n\n```{.r .cell-code}\np6<- ggplot(data=model2_tidy, \n            aes(x=reorder(term, estimate), y=estimate)) +\n  \n         geom_errorbar(aes(ymin=conf.low, \n                           ymax=conf.high), \n                       width = 0.2,size  = 1,\n                       position = \"dodge\", color=\"gray\") +\n  geom_hline(yintercept = 0, color = \"red\", size = 1) +\n  geom_point() + \n    labs(title = \"Diferença do BMI por tipo de cirugia tendo em conta idade e sexo\",\n       x = \"\", \n       y = \"Diference do BMI\") +  \n  coord_flip()\n\np6\n```\n\n::: {.cell-output-display}\n![](Hipoxia_Main_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nDe referir que as cirurgias Removal of gastric restrictive device e Gastroplasty apenas tinham 2 e 3 intervenções que apesar de não terem sido excluídos do modelo limitam a sua análise, podendo existir diferenças.\n\n## Modelo de regressao logaritmico para avaliar se ha diferencas entre o valor de BMI e a duracao de cirurgia ajustado por sexo, idade, e doenças crónicas\n\n::: {.cell}\n\n```{.r .cell-code}\n# hipoxia_lite$type_surg <- as.factor(hipoxia_lite$type_surg)# forcar o R a definir tipo de instituicao como variavel categorica\n# \n# hipoxia_lite$type_surg <- relevel(hipoxia_lite$type_surg, ref = 1)\n# \n# model3_logit <- glm(duration_surg ~  bmi + \n#                       as.factor(sex)+ \n#                       as.factor+\n#                       resting_bp+\n#                       cholesterol, \n#                     family=\"binomial\", \n#                     data=hd)\n# \n# model3_tidy <- tidy(model3_logit, exponentiate = TRUE, conf.int = TRUE)\n# \n# model3_tidy1 <- tidy(model3_logit, exponentiate = FALSE, conf.int = TRUE)\n```\n:::\n\n\n\n## Salvar o gráficos P1 e P2 e P6\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(filename = here::here(\"outputs\", \"figures\", \n                  paste0( \"bmi_lm_gastric\", \".pdf\")),\n                  plot= p1,\n                  width = 20.49,\n                  height = 10.3,\n                  units = c(\"cm\"),\n                  dpi = \"retina\")\nggsave( filename = here::here(\"outputs\", \"figures\", \n                  paste0( \"Duration of Surgery\", \".png\")),\n                  plot= p2,\n                  width = 20.49,\n                  height = 10.3,\n                  units = c(\"cm\"),\n                  dpi = \"retina\")\nggsave( filename = here::here(\"outputs\", \"figures\", \n                  paste0( \"Duration of Surgery\", \".png\")),\n                  plot= p6,\n                  width = 20.49,\n                  height = 10.3,\n                  units = c(\"cm\"),\n                  dpi = \"retina\")\n```\n:::\n\n\n## Carregar uma imagem com um doente com um CPAP para sensibilização\n\n[![Um doente com CPAP](images/doente_cpap.jfif){fig-align=\"center\"}](https://www.sppneumologia.pt/)\n\nConsequências da hipóxia\n\n-   Dor de cabeça;\n\n-   Sonolência;\n\n-   Aumento dos batimentos cardíacos;\n\n-   Suor frio;\n\n-   Falta de ar;\n\n-   Tontura;\n\n-   Confusão mental;\n\n-   Desmaio;\n\n-   Dedos e boca arroxeados (cianose).\n\n\n## Equação\n\n    O valor normal de PaO2 cai com a idade de acordo com a seguinte equação\n\n    $PaO2 = 103,5 - (0,42 * (idade))$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 8. O documento docx ou html deve conter pelo menos, titulos, equacoes, listas e imagem p.e. um doente tipo com CPAP\n```\n:::\n",
    "supporting": [
      "Hipoxia_Main_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"Hipoxia_Main_files/libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"Hipoxia_Main_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"Hipoxia_Main_files/libs/table1-1.0/table1_defaults.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}